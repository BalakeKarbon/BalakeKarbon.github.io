<html lang="eng">
<head>
	<meta charset="utf-8"/>
	<title>web-portfolio</title>
	<link rel="icon" href="res/img/favicon.png" sizes="128x128" type="image/png">
</head>
<body>
	<div id='terminal-container'></div>
	<noscript>You are extra cool because whatever you are viewing this on does not support javascript! Click <a href='nojs.html'>here</a> to go to the pure HTML site suitable for terminals.</noscript>
	<script src="/base.js"></script>
	<script>
		var floppyAudio = [
			new Audio('res/audio/osborne-1/floppy1.mp3'),
			new Audio('res/audio/osborne-1/floppy3.mp3'),
			new Audio('res/audio/osborne-1/floppy2.mp3'),
			new Audio('res/audio/osborne-1/floppy4.mp3'),
			new Audio('res/audio/osborne-1/floppy6.mp3'),
			new Audio('res/audio/osborne-1/floppy5.mp3'),
		];
		var keyAudio = [
			new Audio('res/audio/osborne-1/key1.mp3'),
			new Audio('res/audio/osborne-1/key2.mp3'),
			new Audio('res/audio/osborne-1/key3.mp3'),
			new Audio('res/audio/osborne-1/key4.mp3'),
			new Audio('res/audio/osborne-1/key5.mp3'),
			new Audio('res/audio/osborne-1/key6.mp3'),
			new Audio('res/audio/osborne-1/key7.mp3'),
			new Audio('res/audio/osborne-1/key8.mp3'),
			new Audio('res/audio/osborne-1/key9.mp3'),
			new Audio('res/audio/osborne-1/key10.mp3'),
			new Audio('res/audio/osborne-1/key11.mp3'),
			new Audio('res/audio/osborne-1/key12.mp3'),
			new Audio('res/audio/osborne-1/key13.mp3'),
			new Audio('res/audio/osborne-1/key14.mp3')
		];
		var keyAudioLoop=0;
		var keyAudioPath=[0,1,2,3,4,5,6,7,8,9,10,11,12,13];
		function shuffle(array) {
			var currentIndex = array.length, temporaryValue, randomIndex;
			while (0 !== currentIndex) {
			  randomIndex = Math.floor(Math.random() * currentIndex);
			  currentIndex -= 1;
			  temporaryValue = array[currentIndex];
			  array[currentIndex] = array[randomIndex];
			  array[randomIndex] = temporaryValue;
			}
			return array;
		};
		keyAudioPath=shuffle(keyAudioPath);
		if(getCookie('page')=='gui') {
			window.location.href='gui.html';
		}
		var tabColor = document.createElement('meta');
		document.getElementsByTagName('head')[0].appendChild(tabColor);
		try {
			var local_unifont = new FontFace('localUnifont', 'url(/res/text/fonts/unifont-13.0.01.ttf)');
		}
		catch(error) {
			document.body.innerHTML+='<style>@font-face { font-family: localUnifont; src: url(/res/text/fonts/unifont-13.0.01.ttf); }</style>';
			var local_inufont = null;
		}
		function adjustScale() {
			if(window.innerHeight < (window.innerWidth*0.75)) {
				document.getElementById('terminal-container').style.width=window.innerHeight*1.3333333333333333;
				document.getElementById('terminal-container').style.height=window.innerHeight;
				document.getElementById('terminal-container').style.marginLeft=((window.innerWidth-(window.innerHeight*1.3333333333333333))/2)+'px';
			} else {
				document.getElementById('terminal-container').style.width=window.innerWidth;
				document.getElementById('terminal-container').style.height=window.innerWidth*0.75;
				document.getElementById('terminal-container').style.marginLeft='0%';
			};
		}
		//I WISH I WAS WRITING IN JAVA!
		var fontSize=20;
		var terminalScreenBorder=10;
		var rows=(400-(terminalScreenBorder*2))/fontSize;
		var cols=(500-(terminalScreenBorder*2))/(fontSize/2);
		var scroll=0;
		var terminalLinks=[null,lsHome,aboutMe,contactInfo,resume,lsProjects,function() {
			 window.open("https://github.com/BalakeKarbon/");
		},function() {
			 window.open("https://www.linkedin.com/in/blake-karbon/");
		},popupBlocked,changeColor,cc0,cc1,cc2,graphicalInterface,finishedProjects,currentProjects];
		var terminalBuffer=[];
		var typeRate=50;
		var terminalCanvas=document.createElement("canvas");
		var terminalContext=terminalCanvas.getContext("2d");
		terminalCanvas.width=500;
		terminalCanvas.height=400;
		terminalCanvas.style.position='absolute';
		terminalCanvas.style.top='4.1666666666666664%';
		terminalCanvas.style.left='9.375%';
		terminalCanvas.style.width='62.5%';
		terminalCanvas.style.height='66.66666666666667%';
		var depletionInterval=20;
		var depletionSize=10;
		var rrgb=[0,30,0];
		function deplete() {
			var screenImageData = terminalContext.getImageData(0,0,terminalCanvas.width,terminalCanvas.height);
		  for(var cp=0;cp<screenImageData.data.length;cp+=4) {
		    for(var cc=0;cc<3;cc++) {
		      if(screenImageData.data[cp+cc]!=rrgb[cc]) {
		      	var diff=screenImageData.data[cp+cc]-rrgb[cc];
		        if(diff>0) {
		          if(depletionSize<Math.abs(diff)) {
		          	screenImageData.data[cp+cc]-=depletionSize;
		          } else {
		          	screenImageData.data[cp+cc]-=diff;
		          }
		        } else if(diff<0) {
		        	if(depletionSize<Math.abs(diff)) {
		          	screenImageData.data[cp+cc]+=depletionSize;
		          } else {
		          	screenImageData.data[cp+cc]+=diff;
		          }
		        }
		      }
		    }
		  }
		  terminalContext.putImageData(screenImageData,0,0);
		}
		terminalContext.fillStyle = "#00FF00";
		terminalContext.fillRect(0, 0, terminalCanvas.width, terminalCanvas.height);
		setInterval(function() {
			if(!writingString) {
				deplete();
			}
		},depletionInterval);
		var terminalCursor = {
			x:0,
			y:0
		};
		var terminalLines=[];
		function initTerminalLines() {
			terminalLines=[];
			var tli=0;
			if(terminalLines.length!=0) {
				for(tli=(terminalLines.length-1);tli>=0;tli--) {
					terminalLines[tli].remove()
					terminalLines.pop();
				}
			}
			for(tli=0;tli<rows;tli++) {
				var newLine = document.createElementNS('http://www.w3.org/2000/svg','text');
				newLine.setAttribute('x',75+terminalScreenBorder);
				newLine.setAttribute('y',25+((terminalScreenBorder+((tli)*fontSize))+fontSize));
				newLine.setAttribute('style','font-size:'+fontSize+'px;font-family:localUnifont;fill:#00FF00;fill-opacity:1;stroke:none;stroke-width:0.0');
				newLine.textContent='';
				document.getElementById('terminal').insertBefore(newLine,document.getElementById('terminal').firstChild);
				terminalLines.push(newLine);
			}
		}
		function adjustFont(newSize) {
			fontSize=newSize;
			rows=(400-(terminalScreenBorder*2))/fontSize;
			cols=(500-(terminalScreenBorder*2))/(fontSize/2);
			terminalBuffer=[]; //Reset Buffer!
			terminalCursor.x=0;
			terminalCursor.y=0;
		}
		var lineIndex=0;
		var lineStop=0;
		var regularColor='#00ff00';
		var linkColor='#00aa00';
		function render() {
			deplete();
			if(terminalBuffer.length<=rows) {
				scroll=0;
			}
			lineIndex=(terminalBuffer.length-1)-scroll;
			lineStop=lineIndex-(rows-1);
			if(lineStop<0) {
				lineStop=0;
			}
			while(lineIndex>=lineStop) {
				terminalLines[lineIndex-lineStop].innerHTML='';
				terminalLines[lineIndex-lineStop][1]=[];
				var curText=terminalBuffer[lineIndex];
				for(var curChar=0;curChar<cols;curChar++) {
					if(curText[0].length>curChar) {

						var newLink = document.createElementNS('http://www.w3.org/2000/svg','tspan');
						newLink.setAttribute('fill',regularColor);
						terminalContext.fillStyle = regularColor;
						if(curText[1][curChar]!=0) {
							newLink.onclick=terminalLinks[curText[1][curChar]];
							newLink.setAttribute('fill',linkColor);
							newLink.setAttribute('text-decoration','underline');
							terminalContext.fillStyle = linkColor;
						}
						terminalContext.fillText(curText[0][curChar],terminalScreenBorder+((fontSize/2)*curChar),(terminalScreenBorder+((lineIndex-lineStop)*fontSize))+fontSize);
						if(curText[0].charAt(curChar)==' ') {
							newLink.innerHTML+='&nbsp;';
						} else {
							newLink.innerHTML+=curText[0].charAt(curChar);
						}
						terminalLines[lineIndex-lineStop].appendChild(newLink);
					}
				}
				lineIndex--;
			}
		}
		function setTerminalColor(color) {
			if(color==0) {
				rrgb=[0,40,0];
				regularColor='#00ff00';
				linkColor='#00aa00';
				terminalContext.fillStyle = "#00ff00";
				terminalContext.fillRect(0, 0, terminalCanvas.width, terminalCanvas.height);
				render();
				tabColor.setAttribute('name','theme-color');
				tabColor.setAttribute('content','#00ff00');
				setCookie('terminalColor',0,100);
			} else if(color==1) {
				rrgb=[40,40,40];
				regularColor='#ffffff';
				linkColor='#bbbbbb';
				terminalContext.fillStyle = "#ffffff";
				terminalContext.fillRect(0, 0, terminalCanvas.width, terminalCanvas.height);
				render();
				tabColor.setAttribute('name','theme-color');
				tabColor.setAttribute('content','#ffffff');
				setCookie('terminalColor',1,100);
			} else if(color==2) {
				rrgb=[107,89,37];
				regularColor='#f9bc04';
				linkColor='#dda704';
				terminalContext.fillStyle = "#f9bc04";
				terminalContext.fillRect(0, 0, terminalCanvas.width, terminalCanvas.height);
				render();
				tabColor.setAttribute('name','theme-color');
				tabColor.setAttribute('content','#f9bc04');
				setCookie('terminalColor',2,100);
			}
		}
		function getCurrentLine() {
			if(terminalCursor.y>rows) {
				terminalCursor.y=rows;
			} else if(terminalCursor.y<0) {
				terminalCursor.y=0;
			}
			if(terminalCursor.x>cols) {
				terminalCursor.x=cols;
			} else if(terminalCursor.x<0) {
				terminalCursor.x=0;
			}
			while(terminalBuffer[terminalCursor.y]==null) {
				terminalBuffer.push(['',[]]);
			}
			for(var cbli=0;cbli<cols;cbli++) {
				terminalBuffer[terminalBuffer.length-1][1].push(0);
			}
			var offsetRow=0;
			if(terminalBuffer.length<=rows) {
				offsetRow=terminalCursor.y;
			} else {
				offsetRow=((terminalBuffer.length-1)-rows)+terminalCursor.y;
			}
			var curLine=terminalBuffer[offsetRow];
			while(curLine[0].length<terminalCursor.x) {
				curLine[0]+=' ';
				curLine[1].push(0);
			}
			return [curLine,offsetRow];
		}
		var writingChar=false;
		function setChar(char,link) {
			if(writingChar==false) {
				writingChar=true;
				var curLine=getCurrentLine();
				curLine[0][0]=curLine[0][0].substr(0, terminalCursor.x) + char+ curLine[0][0].substr(terminalCursor.x + 1);
				curLine[0][1][terminalCursor.x]=link;
				writingChar=false;
			}
		}
		var writingString=false;
		var wcnli=0;
		var wccci=0;
		var wcnl=[];
		var wcfll=0;
		var wclink=0;
		function writeCallback() {
			if(wcnli<wcnl.length) {
				if(wccci<wcnl[wcnli].length) {
					terminalCursor.x=wccci;
					if(wcnli==0) {
						terminalCursor.x+=wcfll;
					}
					setChar(wcnl[wcnli].charAt(wccci),wclink);
					wccci++;
					if(wccci>=wcnl[wcnli].length) {
						terminalCursor.x++;
					}
				} else {
					wccci=0;
					wcnli++;
					if(terminalBuffer.length<rows) {
						if(wcnl.length>wcnli) {
							terminalCursor.y++;
							terminalCursor.x=0;
						}
					} else if(wcnli<(wcnl.length)) {
						terminalCursor.y=rows;
						terminalBuffer.push(['',[]]);
						terminalCursor.x=0;
					}
					writeCallback();
				}
				if(wcnli==wcnl.length) {
					writingString=false;
					if(wcnl[wcnl.length-1].charAt(terminalCursor.x)!='') {
						terminalCursor.x++;
					}
					if(terminalCursor.x>cols) {
						terminalCursor.y=rows;
						terminalBuffer.push(['',[]]);
						terminalCursor.x=0;
					}
				}
			}
		}
		function write(tString,link,quick) {
			if(writingString==false) {
				writingString=true;
				var newLines=[''];
				var fll=terminalCursor.x;
				var cls='';
				var nli=0;
				var cc=fll;
				var cci=0;
				for(cci=0;cci<tString.length;cci++) {
					if(tString.charAt(cci)=='\n') {
						newLines.push('');
						nli++;
						cc=0;
					} else {
						newLines[nli]+=tString.charAt(cci);
						if(cc>=(cols-1)) {
							newLines.push('')
							nli++;
							cc=0;
						} else {
							cc++;
						}
					}
				}
				wcnli=0;
				wccci=0;
				wcnl=newLines;
				wcfll=fll;
				wclink=link;
				var cc=0;
				for(nli=0;nli<newLines.length;nli++) {
					for(cci=0;cci<=newLines[nli].length;cci++) {
						if(quick) {
							writeCallback();
							cc++
						} else {
							setTimeout(function() {
								writeCallback();
								keyAudio[keyAudioPath[keyAudioLoop]].play();
								keyAudioLoop++;
								if(keyAudioLoop>=keyAudioPath.length) {
									keyAudioLoop=0;
									keyAudioPath=shuffle(keyAudioPath);
								}
								render();
							},cc*typeRate);
							cc++;
						}
					}
				}
				if(quick) {
					render();
				}
			}
		}
		var runningCommand=false;
		function writeTerminalCursor() {
			write('[',0,true);
			write('futureClient@Web_Portfolio ',0,true);
			write('~/Blake Karbon',1,true);
			write(']$',0,true);
		}
		function popupBlocked() {
			if(!runningCommand) {
				scroll=0;
				runningCommand=true;
				write('cat "Permission Issues.txt"\n',0,false);
				setTimeout(function() {
					floppyAudio[4].play();
					write('If you are reading this you must enable popups for this page in your browser!\n',0,true);
					writeTerminalCursor();
					runningCommand=false;
				},28*typeRate);
			}
		}
		function changeColor() {
			if(!runningCommand) {
				scroll=0;
				runningCommand=true;
				write('./changeColor.bin -lc\n',0,false);
				setTimeout(function() {
					floppyAudio[0].play();
					write('Colors:\n',0,true);
					write('green\n',10,true);
					write('white\n',11,true);
					write('orange\n',12,true);
					writeTerminalCursor();
					runningCommand=false;
				},21*typeRate);
			}
		}
		function graphicalInterface() {
			if(!runningCommand) {
				scroll=0;
				runningCommand=true;
				write('./"Graphical Interface"/start.bin\n',0,false);
				setTimeout(function() {
					floppyAudio[0].play();
					write('Loading GUI.',0,true);
					setTimeout(function() {
						write('.',0,true);
						setTimeout(function() {
							write('.\n',0,true);
							setTimeout(function() {
								write('Opening GUI.\n',0,true);
								setTimeout(function() {
									writeTerminalCursor();
									runningCommand=false;
									setCookie('page','gui',100);
									window.location.href='gui.html';
								},1000);
							},1000);
						},1000);
					},1000);
				},34*typeRate);
			}
		}
		function cc0() {
			if(!runningCommand) {
				scroll=0;
				runningCommand=true;
				write('./changeColor.bin -c green\n',0,false);
				setTimeout(function() {
					floppyAudio[0].play();
					setTerminalColor(0);
					writeTerminalCursor();
					runningCommand=false;
				},27*typeRate);
			}
		}
		function cc1() {
			if(!runningCommand) {
				scroll=0;
				runningCommand=true;
				write('./changeColor.bin -c white\n',0,false);
				setTimeout(function() {
					floppyAudio[0].play();
					setTerminalColor(1);
					writeTerminalCursor();
					runningCommand=false;
				},27*typeRate);
			}
		}
		function cc2() {
			if(!runningCommand) {
				scroll=0;
				runningCommand=true;
				write('./changeColor.bin -c orange\n',0,false);
				setTimeout(function() {
					floppyAudio[0].play();
					setTerminalColor(2);
					writeTerminalCursor();
					runningCommand=false;
				},28*typeRate);
			}
		}
		function aboutMe() {
			if(!runningCommand) {
				scroll=0;
				runningCommand=true;
				write('cat "About Me.txt"\n',0,false);
				setTimeout(function() {
					floppyAudio[2].play();
					loadFile("res/text/lang/eng/about-me.txt",null,function(fileData) {
						write(fileData.responseText+'\n',0,true);
						writeTerminalCursor();
						runningCommand=false;
					});
				},19*typeRate);
			}
		}
		function contactInfo() {
			if(!runningCommand) {
				scroll=0;
				runningCommand=true;
				write('cat "Contact Info.txt"\n',0,false);
				setTimeout(function() {
					floppyAudio[3].play();
					write('Cellular: 720-404-0695\n',0,true);
					write('Email: blakekarbon@gmail.com\n',0,true);
					write('GitHub: ',0,true);
					write('https://github.com/BalakeKarbon/\n',6,true);
					write('LinkedIn: ',0,true);
					write('https://www.linkedin.com/in/blake-karbon/\n',7,true);
					writeTerminalCursor();
					runningCommand=false;
				},23*typeRate);
			}
		}
		function resume() {
			if(!runningCommand) {
				scroll=0;
				runningCommand=true;
				write('less Resume.pdf > /dev/tty2\n',0,false);
				setTimeout(function() {
					floppyAudio[0].play();
					var newWin = window.open('res/text/lang/eng/2019 Resume.pdf');
					if(!newWin || newWin.closed || typeof newWin.closed=='undefined') {
						write('bash: /dev/tty2: ',0,true);
						write('Permission denied\n',8,true);
						writeTerminalCursor();
						setTimeout(function() {
							runningCommand=false;
							popupBlocked();
						},1000);
					} else {
						writeTerminalCursor();
						runningCommand=false;
					}
				},28*typeRate);
			}
		}
		function currentProjects() {
			if(!runningCommand) {
				scroll=0;
				runningCommand=true;
				write('ls projects/current/\n',0,false);
				setTimeout(function() {
					floppyAudio[1].play();
					write('DIY Computer Architectures\n',0,true);
					write('International Harvester\n',0,true);
					write('Vintage Computers\n',0,true);
					writeTerminalCursor();
					runningCommand=false;
				},21*typeRate);
			}
		}
		function finishedProjects() {
			if(!runningCommand) {
				scroll=0;
				runningCommand=true;
				write('ls projects/finished/\n',0,false);
				setTimeout(function() {
					floppyAudio[1].play();
					write('DIY Neural Network',0,true);
					terminalCursor.x=cols/2;
					write('This Website\n',0,true);
					write('ObiCOOL Website',0,true);
					terminalCursor.x=cols/2;
					write('Bluecalf Website\n',0,true);
					write('fileToBitmap',0,true);
					terminalCursor.x=cols/2;
					write('School Security System\n',0,true);
					write('Daily Driver',0,true);
					terminalCursor.x=cols/2;
					write('Lunchbox Laptop\n',0,true);
					writeTerminalCursor();
					runningCommand=false;
				},22*typeRate);
			}
		}
		function lsProjects() {
			if(!runningCommand) {
				scroll=0;
				runningCommand=true;
				write('ls projects\n',0,false);
				setTimeout(function() {
					floppyAudio[2].play();
					write('finished',14,true);
					terminalCursor.x=cols/2;
					write('current\n',15,true);
					writeTerminalCursor();
					runningCommand=false;
				},12*typeRate);
			}
		}
		function lsHome() {
			if(!runningCommand) {
				scroll=0;
				runningCommand=true;
				write('ls\n',0,false);
				setTimeout(function() {
					floppyAudio[2].play();
					write("'About Me.txt'",2,true);
					terminalCursor.x=cols/2;
					write("'Contact Info.txt'\n",3,true);
					write('Resume.pdf',4,true);
					terminalCursor.x=cols/2;
					write("'Permission Issues.txt'\n",0,true);
					write('projects',5,true);
					terminalCursor.x=cols/2;
					write('changeColor.bin\n',9,true);
					write("'Graphical Interface'\n",13,true);
					writeTerminalCursor();
					runningCommand=false;
				},3*typeRate);
			}
		}
		function login() {
			if(!runningCommand) {
				scroll=0;
				runningCommand=true;
				write('Web_Portfolio login:',0,true);
				setTimeout(function() {
					write('futureClient\n',0,false);
					setTimeout(function() {
						write('Password:',0,true);
						setTimeout(function(){
							//write('\nWelcome!\nLast login: Mon Mar 22 1965 on tty\n\n',0,true); Release date of the PDP-8 computer!
							write('\nWelcome!\nLast login: Thu Jan 1 1970 00:00:00 on tty\n\n',0,true);
							writeTerminalCursor();
							setTimeout(function() {
								runningCommand=false;
								lsHome();
							},600);
						},13*typeRate);
					},13*typeRate);
				},1000);
			}
		}
		var sc=false;
		window.addEventListener('wheel', function(event) {
			if(!runningCommand && !writingString && !writingChar) {
				if(event.deltaY>0){
					if(!sc) {
						sc=true;
						if(scroll!=0) {
							scroll+=-1;
						}
						render();
						setTimeout(function() {
							sc=false;
						},10);
					}
				} else if(event.deltaY<0) {
					if(!sc) {
						sc=true;
						if(scroll<(terminalBuffer.length-rows)) {
							scroll+=1;
						}
						render();
						setTimeout(function() {
							sc=false;
						},10);
					}
				}
			}
		});
		function start() {
			login();
		}
		function main(fileData) {
			document.getElementById('terminal-container').innerHTML=fileData.responseText;
			document.getElementById('terminal').setAttribute('width','100%');
			document.getElementById('terminal').setAttribute('height','100%');
			document.getElementById('terminal').style.zIndex='-1';
			adjustScale();
			document.getElementById('terminal-container').insertBefore(terminalCanvas,document.getElementById('terminal-container').firstChild);
			terminalCanvas.style.zIndex='-2';
			terminalContext.font=fontSize+'px localUnifont';
			terminalContext.fillStyle = '#00ff00';
			initTerminalLines();
			setTerminalColor(getCookie('terminalColor'));
			if(local_unifont!=null) {
				local_unifont.load().then(function(loaded_face) {
					document.fonts.add(loaded_face);
					start();
				}).catch(function(error) {
					console.log(error);
				});
			} else {
				start();
			}
		};
		loadFile("res/img/terminal.svg",null,main);
		window.addEventListener('resize',adjustScale);
	</script>
	<style>
		body {
			margin: 0px 0px 0px 0px;
		}
		#terminal-container {
			position: absolute;
		}
	</style>
</body>
</html>
