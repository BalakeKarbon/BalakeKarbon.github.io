<html lang="eng">
<head>
	<meta charset="utf-8"/>
	<title>web-portfolio</title>
</head>
<body>
	<div id='terminal-container'></div>
	<noscript>You are extra cool because whatever you are viewing this on does not support javascript!</noscript>
	<script src="/base.js"></script>
	<script>
		try {
			var local_unifont = new FontFace('localUnifont', 'url(/res/text/fonts/unifont-13.0.01.ttf)');
		}
		catch(error) {
			document.body.innerHTML+='<style>@font-face { font-family: localUnifont; src: url(/res/text/fonts/unifont-13.0.01.ttf); }</style>';
			var local_inufont = null;
		}
		function adjustScale() {
			if(window.innerHeight < (window.innerWidth*0.75)) {
				document.getElementById('terminal-container').style.width=window.innerHeight*1.3333333333333333;
				document.getElementById('terminal-container').style.height=window.innerHeight;
				document.getElementById('terminal-container').style.marginLeft=((window.innerWidth-(window.innerHeight*1.3333333333333333))/2)+'px';
			} else {
				document.getElementById('terminal-container').style.width=window.innerWidth;
				document.getElementById('terminal-container').style.height=window.innerWidth*0.75;
				document.getElementById('terminal-container').style.marginLeft='0%';
			};
		}
		//I WISH I WAS WRITING IN JAVA!
		var fontSize=20;
		var terminalScreenBorder=10;
		var rows=(400-(terminalScreenBorder*2))/fontSize;
		var cols=(500-(terminalScreenBorder*2))/(fontSize/2);
		var scroll=0;
		var terminalLinks=[null,lsHome,aboutMe,contactInfo,resume,projects,function() {
			 window.open("https://github.com/BalakeKarbon/");
		},function() {
			 window.open("https://www.linkedin.com/in/blake-karbon/");
		}]; //Setup links first then revert back to them!
		var terminalBuffer=[]; //Array of strings with the length of cols along with integer array referencing links.
		var typeRate=50;
		var terminalCanvas=document.createElement("canvas");
		var terminalContext=terminalCanvas.getContext("2d");
		terminalCanvas.width=500;
		terminalCanvas.height=400;
		terminalCanvas.style.position='absolute';
		terminalCanvas.style.top='4.1666666666666664%';
		terminalCanvas.style.left='9.375%';
		terminalCanvas.style.width='62.5%';
		terminalCanvas.style.height='66.66666666666667%';
		var depletionInterval=20;
		var depletionSize=10;
		var rrgb=[0,30,0];
		function deplete() {
			var screenImageData = terminalContext.getImageData(0,0,terminalCanvas.width,terminalCanvas.height);
		  for(var cp=0;cp<screenImageData.data.length;cp+=4) {
		    for(var cc=0;cc<3;cc++) {
		      if(screenImageData.data[cp+cc]!=rrgb[cc]) {
		      	var diff=screenImageData.data[cp+cc]-rrgb[cc];
		        if(diff>0) {
		          if(depletionSize<Math.abs(diff)) {
		          	screenImageData.data[cp+cc]-=depletionSize;
		          } else {
		          	screenImageData.data[cp+cc]-=diff;
		          }
		        } else if(diff<0) {
		        	if(depletionSize<Math.abs(diff)) {
		          	screenImageData.data[cp+cc]+=depletionSize;
		          } else {
		          	screenImageData.data[cp+cc]+=diff;
		          }
		        }
		      }
		    }
		  }
		  terminalContext.putImageData(screenImageData,0,0);
		}
		terminalContext.fillStyle = "#00FF00";
		terminalContext.fillRect(0, 0, terminalCanvas.width, terminalCanvas.height);
		setInterval(function() {
			if(!writingString) {
				deplete();
			}
		},depletionInterval);
		var terminalCursor = {
			x:0,
			y:0
		};
		var terminalLines=[];
		function initTerminalLines() {
			terminalLines=[];
			var tli=0;
			if(terminalLines.length!=0) {
				for(tli=(terminalLines.length-1);tli>=0;tli--) {
					terminalLines[tli].remove()
					terminalLines.pop();
				}
			}
			for(tli=0;tli<rows;tli++) {
				var newLine = document.createElementNS('http://www.w3.org/2000/svg','text');
				newLine.setAttribute('x',75+terminalScreenBorder);
				newLine.setAttribute('y',25+((terminalScreenBorder+((tli)*fontSize))+fontSize));
				newLine.setAttribute('style','font-size:'+fontSize+'px;font-family:localUnifont;fill:#00FF00;fill-opacity:1;stroke:none;stroke-width:0.0');
				newLine.textContent='';
				document.getElementById('terminal').insertBefore(newLine,document.getElementById('terminal').firstChild);
				terminalLines.push(newLine);
			}
		}
		function adjustFont(newSize) {
			fontSize=newSize;
			rows=(400-(terminalScreenBorder*2))/fontSize;
			cols=(500-(terminalScreenBorder*2))/(fontSize/2);
			terminalBuffer=[]; //Reset Buffer!
			terminalCursor.x=0;
			terminalCursor.y=0;
		}
		var lineIndex=0;
		var lineStop=0;
		var regularColor='#00ff00';
		var linkColor='#00aa00';
		function render() {
			deplete();
			if(terminalBuffer.length<=rows) {
				scroll=0;
			}
			lineIndex=(terminalBuffer.length-1)-scroll;
			lineStop=lineIndex-(rows-1);
			if(lineStop<0) {
				lineStop=0;
			}
			while(lineIndex>=lineStop) {
				terminalLines[lineIndex-lineStop].innerHTML='';
				terminalLines[lineIndex-lineStop][1]=[];
				var curText=terminalBuffer[lineIndex];
				for(var curChar=0;curChar<cols;curChar++) {
					if(curText[0].length>curChar) {

						var newLink = document.createElementNS('http://www.w3.org/2000/svg','tspan');
						newLink.setAttribute('fill',regularColor);
						terminalContext.fillStyle = regularColor;
						if(curText[1][curChar]!=0) {
							newLink.onclick=terminalLinks[curText[1][curChar]];
							newLink.setAttribute('fill',linkColor);
							terminalContext.fillStyle = linkColor;
						}
						terminalContext.fillText(curText[0][curChar],terminalScreenBorder+((fontSize/2)*curChar),(terminalScreenBorder+((lineIndex-lineStop)*fontSize))+fontSize);
						if(curText[0].charAt(curChar)==' ') {
							newLink.innerHTML+='&nbsp;';
						} else {
							newLink.innerHTML+=curText[0].charAt(curChar);
						}
						terminalLines[lineIndex-lineStop].appendChild(newLink);
					}
				}
				lineIndex--;
			}
		}
		function getCurrentLine() {
			if(terminalCursor.y>rows) {
				terminalCursor.y=rows;
			} else if(terminalCursor.y<0) {
				terminalCursor.y=0;
			}
			if(terminalCursor.x>cols) {
				terminalCursor.x=cols;
			} else if(terminalCursor.x<0) {
				terminalCursor.x=0;
			}
			while(terminalBuffer[terminalCursor.y]==null) {
				terminalBuffer.push(['',[]]);
			}
			for(var cbli=0;cbli<cols;cbli++) {
				terminalBuffer[terminalBuffer.length-1][1].push(0);
			}
			var offsetRow=0;
			if(terminalBuffer.length<=rows) {
				offsetRow=terminalCursor.y;
			} else {
				offsetRow=((terminalBuffer.length-1)-rows)+terminalCursor.y;
			}
			var curLine=terminalBuffer[offsetRow];
			while(curLine[0].length<terminalCursor.x) {
				curLine[0]+=' ';
				curLine[1].push(0);
			}
			return [curLine,offsetRow];
		}
		var writingChar=false;
		function setChar(char,link) {
			if(writingChar==false) {
				writingChar=true;
				var curLine=getCurrentLine();
				curLine[0][0]=curLine[0][0].substr(0, terminalCursor.x) + char+ curLine[0][0].substr(terminalCursor.x + 1);
				curLine[0][1][terminalCursor.x]=link;
				writingChar=false;
			}
		}
		var writingString=false;
		var wcnli=0;
		var wccci=0;
		var wcnl=[];
		var wcfll=0;
		var wclink=0;
		function writeCallback() {
			if(wcnli<wcnl.length) {
				if(wccci<wcnl[wcnli].length) {
					terminalCursor.x=wccci;
					if(wcnli==0) {
						terminalCursor.x+=wcfll;
					}
					setChar(wcnl[wcnli].charAt(wccci),wclink);
					wccci++;
					if(wccci>=wcnl[wcnli].length) {
						terminalCursor.x++;
					}
				} else {
					wccci=0;
					wcnli++;
					if(terminalBuffer.length<rows) {
						if(wcnl.length>wcnli) {
							terminalCursor.y++;
							terminalCursor.x=0;
						}
					} else if(wcnli<(wcnl.length)) {
						terminalCursor.y=rows;
						terminalBuffer.push(['',[]]);
						terminalCursor.x=0;
					}
					writeCallback();
				}
				if(wcnli==wcnl.length) {
					writingString=false;
					if(wcnl[wcnl.length-1].charAt(terminalCursor.x)!='') {
						terminalCursor.x++;
					}
					if(terminalCursor.x>cols) {
						terminalCursor.y=rows;
						terminalBuffer.push(['',[]]);
						terminalCursor.x=0;
					}
				}
			}
		}
		function write(tString,link,quick) {
			if(writingString==false) {
				writingString=true;
				var newLines=[''];
				var fll=terminalCursor.x;
				var cls='';
				var nli=0;
				var cc=fll;
				var cci=0;
				for(cci=0;cci<tString.length;cci++) {
					if(tString.charAt(cci)=='\n') {
						newLines.push('');
						nli++;
						cc=0;
					} else {
						newLines[nli]+=tString.charAt(cci);
						if(cc>=(cols-1)) {
							newLines.push('')
							nli++;
							cc=0;
						} else {
							cc++;
						}
					}
				}
				wcnli=0;
				wccci=0;
				wcnl=newLines;
				wcfll=fll;
				wclink=link;
				var cc=0;
				for(nli=0;nli<newLines.length;nli++) {
					for(cci=0;cci<=newLines[nli].length;cci++) {
						if(quick) {
							writeCallback();
							cc++
						} else {
							setTimeout(function() {
								writeCallback();
								render();
							},cc*typeRate);
							cc++;
						}
					}
				}
				if(quick) {
					render();
				}
			}
		}
		var runningCommand=false;
		function aboutMe() {
			if(!runningCommand) {
				runningCommand=true;
				write('cat about-me.txt\n',0,false);
				setTimeout(function() {
					loadFile("res/text/lang/eng/about-me.txt",null,function(fileData) {
						write(fileData.responseText+'\n',0,true);
						write('[',0,true);
						write('~/home',1,true);
						write(']$',0,true);
						runningCommand=false;
					});
				},17*typeRate);
			}
		}
		function contactInfo() {
			if(!runningCommand) {
				runningCommand=true;
				write('cat contact-info.txt\n',0,false);
				setTimeout(function() {
					write('Cellular: 720-404-0695\n',0,true);
					write('Email: blakekarbon@gmail.com\n',0,true);
					write('GitHub: ',0,true);
					write('https://github.com/BalakeKarbon/\n',6,true);
					write('LinkedIn: ',0,true);
					write('https://www.linkedin.com/in/blake-karbon/\n',7,true);
					write('[',0,true);
					write('~/home',1,true);
					write(']$',0,true);
					runningCommand=false;
				},21*typeRate);
			}
		}
		function resume() {
			if(!runningCommand) {
				runningCommand=true;
				write('./resume.pdf\n',0,false);
				setTimeout(function() {
					window.open('res/text/lang/eng/2019 Resume.pdf');
					write('[',0,true);
					write('~/home',1,true);
					write(']$',0,true);
					runningCommand=false;
				},13*typeRate);
			}
		}
		function projects() {
			if(!runningCommand) {
				runningCommand=true;
				write('ls projects\n',0,false);
				setTimeout(function() {
					write(' Demo Project 1.bin\n',0,true);
					write(' Demo Project 2.bin\n',0,true);
					write(' Demo Project 3.bin\n',0,true);
					write(' Demo Project 4.bin\n',0,true);
					write(' Demo Project 5.bin\n',0,true);
					write(' Demo Project 6.bin\n',0,true);
					write(' Demo Project 7.bin\n',0,true);
					write(' Demo Project 8.bin\n',0,true);
					write('[',0,true);
					write('~/home',1,true);
					write(']$',0,true);
					runningCommand=false;
				},12*typeRate);
			}
		}
		function lsHome() {
			if(!runningCommand) {
				runningCommand=true;
				write('ls\n',0,false);
				setTimeout(function() {
					write(' about-me.txt\n',2,true);
					write(' contact-info.txt\n',3,true);
					write(' resume.pdf\n',4,true);
					write(' projects\n',5,true);
					write('[',0,true);
					write('~/home',1,true);
					write(']$',0,true);
					runningCommand=false;
				},3*typeRate);
			}
		}
		function login() {
			if(!runningCommand) {
				runningCommand=true;
				write('Web_Portfolio login:',0,true);
				setTimeout(function() {
					write('futureClient\n',0,false);
					setTimeout(function() {
						write('Password:',0,true);
						setTimeout(function(){
							//write('\nWelcome!\nLast login: Mon Mar 22 1965 on tty\n\n',0,true); Release date of the PDP-8 computer!
							write('\nWelcome!\nLast login: Thu Jan 1 1970 00:00:00 on tty\n\n',0,true);
							write('[',0,true);
							write('~/home',1,true);
							write(']$',0,true);
							setTimeout(function() {
								runningCommand=false;
								lsHome();
							},600);
						},13*typeRate);
					},13*typeRate);
				},1000);
			}
		}
		function start() {
			login();
		}
		function main(fileData) {
			document.getElementById('terminal-container').innerHTML=fileData.responseText;
			document.getElementById('terminal').setAttribute('width','100%');
			document.getElementById('terminal').setAttribute('height','100%');
			document.getElementById('terminal').style.zIndex='-1';
			adjustScale();
			document.getElementById('terminal-container').insertBefore(terminalCanvas,document.getElementById('terminal-container').firstChild);
			terminalCanvas.style.zIndex='-2';
			terminalContext.font=fontSize+'px localUnifont';
			terminalContext.fillStyle = '#00ff00';
			initTerminalLines();
			//RENDER SOME LOADING STATUS DEAL LIKE MAYBE A BLINKING LED
			if(local_unifont!=null) {
				local_unifont.load().then(function(loaded_face) {
					document.fonts.add(loaded_face);
					start();

					/*var toggle=0;
					terminalLinks.push(function() {
						if(!writingString) {
							if(toggle==0) {
								toggle++;
								write('This is not a link!',0,false);
							} else {
								toggle=0;
								write('This is a link!',1,false);
							}
						}
					});
					write('This is a link!',1,false);*/
					/*loadFile("res/text/lang/eng/test.txt",null,function(fileData) {
						write(fileData.responseText,0,false);
					});*/

					//Get cookie data here and load values!
				}).catch(function(error) {
					console.log(error);
				});
			} else {
				start();
			}
		};
		loadFile("res/img/terminal.svg",null,main);
		window.addEventListener('resize',adjustScale);
	</script>
	<style>
		/*@font-face {
			font-family: localUnifont;
			src: url(/res/text/fonts/unifont-13.0.01.ttf);
		}*/
		body {
			margin: 0px 0px 0px 0px;
		}
		#terminal-container {
			position: absolute;
		}
	</style>
</body>
</html>
